{% extends "base.html" %} {% import "_macros.html" as macros %} {% block title
%}결재 대기 · Vacation System{% endblock %} {% block page_title %}결재 대기
목록{% endblock %} {% block content %} {% if not approval_list or
approval_list|length == 0 %}
<div class="center" style="min-height: 120px">
  <div class="muted">현재 결재 대기 중인 신청이 없습니다.</div>
</div>
{% else %} {% set type_labels =
{'annual':'연차','am_half_day':'반차(오전)','pm_half_day':'반차(오후)'} %} {%
set status_labels = { 'pending_part_leader':'결재 대기(파트장)',
'pending_team_leader':'결재 대기(팀장)', 'approved':'승인', 'rejected':'반려' }
%}
<table class="table">
  <thead>
    <tr>
      <th>신청자</th>
      <th>종류</th>
      <th>기간</th>
      <th>사유</th>
      <th>상태</th>
      <th>작업</th>
    </tr>
  </thead>
  <tbody>
    {% for item in approval_list %} {% set v = item.details %} {% set s =
    (v.status|string) %} {% set is_pending = s in
    ['pending_part_leader','pending_team_leader'] %}
    <tr>
      <td>{{ item.applicant }}</td>
      <td>{{ type_labels.get(v.vacation_type, v.vacation_type) }}</td>
      <td>{{ v.start_date }} ~ {{ v.end_date }}</td>
      <td>{{ v.reason }}</td>
      <td>
        <span
          class="badge {{ 'warn' if is_pending else ('success' if s=='approved' else 'danger') }}"
        >
          {{ status_labels.get(s, s) }}
        </span>
      </td>
      <td>
        {% if is_pending %}
        <form
          method="post"
          action="{{ url_for('approve_vacation', vacation_id=item.id) }}"
          style="display: inline"
        >
          <button class="btn success" type="submit">승인</button>
        </form>
        <form
          method="post"
          action="{{ url_for('reject_vacation', vacation_id=item.id) }}"
          style="display: inline"
        >
          <button class="btn danger" type="submit">반려</button>
        </form>
        {% else %}
        <span class="muted">처리됨</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %} {% endblock %}
